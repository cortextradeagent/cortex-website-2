<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="/cortex-logo.png">
<title>Documentation - Cortex Agent</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Geist:wght@300;400;500;600;700&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap">
  <style>
    .font-geist { font-family: 'Geist', sans-serif !important; }

    body {
      font-family: 'Geist', 'Inter', sans-serif;
      background-color: #05080A;
    }

    ::-webkit-scrollbar { width: 5px; height: 5px; }
    ::-webkit-scrollbar-track { background: #05080A; }
    ::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
    ::-webkit-scrollbar-thumb:hover { background: #444; }

    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    .token-keyword { color: #ffffff; }
    .token-function { color: #60a5fa; }
    .token-string { color: #a5b4fc; }
    .token-comment { color: #475569; }
    .token-operator { color: #94a3b8; }
    .token-number { color: #fca5a5; }

    html { scroll-behavior: smooth; scroll-padding-top: 100px; }

    .fade-in { animation: fadeIn 0.3s ease-out forwards; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body class="bg-[#05080A] min-h-screen flex flex-col text-white/70 antialiased selection:bg-[#ffffff]/30 selection:text-[#ffffff]">

    <!-- Standard Unified Header -->
    <header class="border-dashed sticky z-50 bg-[#000000] w-full top-0 backdrop-blur-md">
      <div class="grid grid-cols-12 h-16 sm:h-20">
        <!-- Mobile Menu Trigger (Left on mobile) -->
        <div class="col-span-3 md:hidden flex items-center pl-4 border-r border-dashed border-white/10">
          <button id="mobile-menu-btn" class="p-2 hover:bg-white/10 rounded-md transition-colors" aria-label="Open menu">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-white"><path d="M4 5h16"></path><path d="M4 12h16"></path><path d="M4 19h16"></path></svg>
          </button>
        </div>

        <!-- Left Links (Desktop only) -->
        <div class="col-span-4 hidden md:flex items-center">
          <a href="/Platform" class="flex items-center justify-center hover:bg-[#ffffff]/10 transition-colors border-dashed text-xs font-medium text-white tracking-wide font-geist h-full border-white/10 border-r pr-8 pl-8">
            PLATFORM
          </a>
          <a href="/Solution" class="flex items-center justify-center hover:bg-[#ffffff]/10 hover:text-white transition-colors border-dashed text-xs font-medium tracking-wide font-geist h-full border-white/10 border-r pr-8 pl-8">
            SOLUTIONS
          </a>
          <a href="/Pricing" class="flex items-center justify-center hover:bg-[#ffffff]/10 hover:text-white transition-colors border-dashed text-xs font-medium tracking-wide font-geist h-full border-white/10 border-r pr-8 pl-8">
            PRICING
          </a>
        </div>

        <!-- Logo Center -->
        <div class="col-span-6 md:col-span-4 flex relative items-center justify-center">
          <a href="/" class="inline-flex items-center justify-center gap-2">
            <img src="cortex-logo.png" alt="Cortex Agent" class="h-10 w-auto">
            <span class="text-white font-geist font-semibold text-lg tracking-tight hidden sm:inline">CORTEX</span>
          </a>
        </div>

        <!-- Right Links -->
        <div class="col-span-3 md:col-span-4 flex items-center justify-end">
          <a href="/Docs" class="hidden md:flex items-center justify-center border-dashed hover:bg-[#ffffff]/20 transition-colors text-xs font-medium text-white tracking-wide font-geist bg-[#ffffff]/10 h-full border-white/20 border pr-8 pl-8">
            DOCS
          </a>
          <a href="/Enterprise" class="hidden md:flex items-center justify-center hover:bg-[#ffffff]/10 hover:text-white transition-colors border-dashed text-xs font-medium tracking-wide font-geist h-full border-white/10 border-r border-l pr-8 pl-8">
            ENTERPRISE
          </a>
          <a href="/Login" class="flex items-center justify-center hover:text-[#ffffff] transition-colors gap-2 text-xs font-medium text-white tracking-wide font-geist h-full pr-4 md:pr-8 pl-4 md:pl-8">
            <span class="hidden sm:inline">LOGIN</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg>
          </a>
        </div>
      </div>
      <div class="absolute bottom-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/10 to-transparent"></div>
    </header>

    <!-- Mobile Sidebar Overlay -->
    <div id="mobile-sidebar-overlay" class="fixed inset-0 bg-black/80 z-40 hidden md:hidden" onclick="closeMobileMenu()"></div>

    <!-- Mobile Sidebar -->
    <aside id="mobile-sidebar" class="fixed top-0 left-0 w-80 h-full bg-[#05080A] z-50 transform -translate-x-full transition-transform duration-300 md:hidden overflow-y-auto border-r border-white/10">
      <div class="p-6">
        <div class="flex items-center justify-between mb-8">
          <span class="text-white font-semibold">Documentation</span>
          <button onclick="closeMobileMenu()" class="p-2 hover:bg-white/10 rounded-md transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
          </button>
        </div>
        <nav class="space-y-6" id="mobile-nav"></nav>
      </div>
    </aside>

    <!-- Main Docs Layout -->
    <div class="flex-grow max-w-screen-2xl mx-auto w-full grid grid-cols-1 md:grid-cols-12 relative mt-16">
      <!-- Left Sidebar (Navigation) -->
      <aside class="hidden md:block col-span-3 sticky top-16 h-[calc(100vh-4rem)] overflow-y-auto border-dashed border-r border-white/10 pt-8 pb-10 pl-8 pr-4">
        <div class="relative mb-8 group">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-slate-500 group-focus-within:text-[#ffffff] transition-colors">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.3-4.3"></path>
            </svg>
          </div>
          <input type="text" id="search-input" placeholder="Search documentation..." class="w-full bg-white/5 border border-white/10 text-white text-xs rounded-md py-2.5 pl-9 pr-10 focus:outline-none focus:border-[#ffffff]/30 focus:bg-white/10 focus:ring-1 focus:ring-[#ffffff]/30 placeholder:text-slate-600 font-geist transition-all">
          <div id="search-results" class="absolute top-full left-0 right-0 mt-2 bg-[#0A0D11] border border-white/10 rounded-lg shadow-xl z-50 hidden max-h-64 overflow-y-auto"></div>
        </div>
        <nav class="space-y-8">
          <!-- Section 1: Architecture -->
          <div class="">
            <h4 class="text-[11px] uppercase tracking-widest font-semibold text-[#ffffff] mb-4 pl-3">
              Architecture
            </h4>
            <ul class="space-y-0.5" id="nav-architecture">
              <li class="">
                <a href="#" data-page="system-overview" class="nav-link flex items-center gap-2 text-sm font-medium text-white bg-white/5 border-white/5 border rounded-md pt-2 pr-3 pb-2 pl-3">
                  <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff]"></span>
                  System Overview
                </a>
              </li>
              <li class="">
                <a href="#" data-page="data-layer" class="nav-link flex items-center gap-2 px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all border border-transparent">
                  <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                  Data Layer
                </a>
              </li>
              <li>
                <a href="#" data-page="ml-pipeline" class="nav-link flex items-center gap-2 px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all border border-transparent">
                  <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                  ML Pipeline
                </a>
              </li>
            </ul>
          </div>

          <!-- Section 2: Agent Layer -->
          <div>
            <h4 class="text-[11px] uppercase tracking-widest font-semibold text-slate-500 mb-4 pl-3">
              Agent Layer
            </h4>
            <ul class="space-y-0.5" id="nav-agents">
              <li>
                <a href="#" data-page="analyst-agents" class="nav-link flex items-center justify-between px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all group border border-transparent">
                  <div class="flex items-center gap-2">
                    <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                    <span>Analyst Agents</span>
                  </div>
                </a>
              </li>
              <li>
                <a href="#" data-page="researcher-agents" class="nav-link flex items-center justify-between px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all group border border-transparent">
                  <div class="flex items-center gap-2">
                    <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                    <span>Researcher Agents</span>
                  </div>
                </a>
              </li>
              <li>
                <a href="#" data-page="decision-agents" class="nav-link flex items-center justify-between px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all group border border-transparent">
                  <div class="flex items-center gap-2">
                    <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                    <span>Decision Agents</span>
                  </div>
                </a>
              </li>
            </ul>
          </div>

          <!-- Section 3: Execution -->
          <div>
            <h4 class="text-[11px] uppercase tracking-widest font-semibold text-slate-500 mb-4 pl-3">
              Execution
            </h4>
            <ul class="space-y-0.5" id="nav-execution">
              <li>
                <a href="#" data-page="execution-layer" class="nav-link flex items-center gap-2 px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all border border-transparent">
                  <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                  Execution Layer
                </a>
              </li>
              <li>
                <a href="#" data-page="frameworks" class="nav-link flex items-center gap-2 px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all border border-transparent">
                  <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                  Agent Frameworks
                </a>
              </li>
            </ul>
          </div>

          <!-- Section 4: Strategies -->
          <div>
            <h4 class="text-[11px] uppercase tracking-widest font-semibold text-slate-500 mb-4 pl-3">
              Strategies
            </h4>
            <ul class="space-y-0.5" id="nav-strategies">
              <li>
                <a href="#" data-page="lp-rebalancing" class="nav-link flex items-center gap-2 px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all border border-transparent">
                  <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                  LP Rebalancing
                </a>
              </li>
              <li>
                <a href="#" data-page="arbitrage" class="nav-link flex items-center gap-2 px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all border border-transparent">
                  <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                  Arbitrage
                </a>
              </li>
              <li>
                <a href="#" data-page="perpetuals" class="nav-link flex items-center gap-2 px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all border border-transparent">
                  <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                  Perpetuals
                </a>
              </li>
            </ul>
          </div>

          <!-- Section 5: Operations -->
          <div>
            <h4 class="text-[11px] uppercase tracking-widest font-semibold text-slate-500 mb-4 pl-3">
              Operations
            </h4>
            <ul class="space-y-0.5" id="nav-operations">
              <li>
                <a href="#" data-page="monitoring" class="nav-link flex items-center gap-2 px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all border border-transparent">
                  <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                  Monitoring & Alerts
                </a>
              </li>
              <li>
                <a href="#" data-page="circuit-breakers" class="nav-link flex items-center gap-2 px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all border border-transparent">
                  <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                  Circuit Breakers
                </a>
              </li>
              <li>
                <a href="#" data-page="logging" class="nav-link flex items-center gap-2 px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all border border-transparent">
                  <span class="indicator w-1.5 h-1.5 rounded-full bg-[#ffffff] hidden"></span>
                  Performance Logging
                </a>
              </li>
            </ul>
          </div>
        </nav>
      </aside>

      <!-- Main Content Area -->
      <main class="col-span-12 md:col-span-9 xl:col-span-7 px-6 md:px-12 py-10 md:py-16 min-h-screen">
        <div id="content-container" class="">
                <div class="fade-in">
                  <!-- Breadcrumbs -->
                  <div class="flex items-center gap-2 text-xs text-slate-500 mb-8 font-mono">
                    <span>DOCS</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="m9 18 6-6-6-6"></path>
                    </svg>
                    <span class="">ARCHITECTURE</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="m9 18 6-6-6-6"></path>
                    </svg>
                    <span class="text-[#ffffff] uppercase">System Overview</span>
                  </div>

                  <!-- Header -->
                  <h1 class="text-4xl md:text-5xl font-light tracking-tighter text-white mb-6">
                    System Overview
                  </h1>
                  <p class="text-lg md:text-xl text-white/60 font-light leading-relaxed mb-10 max-w-3xl">
                    Multi-agent autonomous trading system with adversarial validation, designed for survival over profit maximization.
                  </p>

                  <!-- Design Philosophy Alert -->
                  <div class="mb-12 p-1 bg-gradient-to-r from-[#ffffff]/20 to-transparent rounded-lg border border-[#ffffff]/20">
                    <div class="bg-[#0A0D11] rounded p-5 flex items-start gap-4">
                      <div class="p-2 bg-[#ffffff]/10 rounded text-[#ffffff] mt-1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>
                      </div>
                      <div>
                        <h4 class="text-white font-medium text-sm mb-1">Design Philosophy</h4>
                        <p class="text-sm text-slate-400 leading-relaxed">
                          Survival over profit maximization. Multi-agent adversarial validation. Hard risk limits at every layer. No single point of failure.
                        </p>
                      </div>
                    </div>
                  </div>

                  <div class="prose prose-invert prose-slate max-w-none">
                    <!-- Agent Composition -->
                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6 flex items-center gap-3">
                      Agent Composition
                    </h2>
                    <p class="mb-6 text-sm leading-7 text-slate-400">
                      9 specialized agents work in adversarial configuration to ensure robust decision-making with no single point of failure.
                    </p>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-12">
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <div class="text-3xl font-light text-white mb-2">4</div>
                        <h3 class="text-white font-medium mb-1">Analyst Agents</h3>
                        <p class="text-sm text-slate-400">Data interpretation specialists</p>
                      </div>
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <div class="text-3xl font-light text-white mb-2">2</div>
                        <h3 class="text-white font-medium mb-1">Researcher Agents</h3>
                        <p class="text-sm text-slate-400">Deep analysis experts</p>
                      </div>
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <div class="text-3xl font-light text-white mb-2">3</div>
                        <h3 class="text-white font-medium mb-1">Decision Agents</h3>
                        <p class="text-sm text-slate-400">Trader, Risk Manager, Portfolio Manager</p>
                      </div>
                    </div>

                    <!-- Decision Flow -->
                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Decision Flow</h2>
                    <div class="border-l border-dashed border-white/10 pl-8 space-y-10 relative mt-6 mb-12">
                      <div class="relative">
                        <span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">1</span>
                        <h3 class="text-white font-medium mb-1">Data Ingestion</h3>
                        <p class="text-sm text-slate-400">400ms cycles from 9+ data sources</p>
                      </div>
                      <div class="relative">
                        <span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">2</span>
                        <h3 class="text-white font-medium mb-1">ML Regime Classification</h3>
                        <p class="text-sm text-slate-400">Market state identification</p>
                      </div>
                      <div class="relative">
                        <span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">3</span>
                        <h3 class="text-white font-medium mb-1">Analyst Reports</h3>
                        <p class="text-sm text-slate-400">4 specialized analyses generated</p>
                      </div>
                      <div class="relative">
                        <span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">4</span>
                        <h3 class="text-white font-medium mb-1">Adversarial Debate</h3>
                        <p class="text-sm text-slate-400">Multi-round challenge/defense cycles</p>
                      </div>
                      <div class="relative">
                        <span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">5</span>
                        <h3 class="text-white font-medium mb-1">Trade Proposal</h3>
                        <p class="text-sm text-slate-400">Trader agent identifies opportunity</p>
                      </div>
                      <div class="relative">
                        <span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">6</span>
                        <h3 class="text-white font-medium mb-1">Risk Assessment</h3>
                        <p class="text-sm text-slate-400">Position sizing and limit checks</p>
                      </div>
                      <div class="relative">
                        <span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">7</span>
                        <h3 class="text-white font-medium mb-1">Final Approval</h3>
                        <p class="text-sm text-slate-400">Portfolio Manager decision</p>
                      </div>
                      <div class="relative">
                        <span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#ffffff] text-black text-[10px] font-semibold ring-4 ring-[#05080A] shadow-[0_0_10px_rgba(255,255,255,0.3)]">8</span>
                        <h3 class="text-white font-medium mb-1">Execution via Guardian</h3>
                        <p class="text-sm text-slate-400">Final validation and blockchain execution</p>
                      </div>
                    </div>

                    <!-- Summary Metrics Table -->
                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Summary Metrics</h2>
                    <div class="overflow-hidden rounded-lg border border-white/10 mb-12">
                      <table class="w-full text-left text-sm border-collapse">
                        <thead>
                          <tr class="bg-white/5 border-b border-white/10">
                            <th class="py-3 px-4 font-medium text-white border-r border-dashed border-white/10">Component</th>
                            <th class="py-3 px-4 font-medium text-white">Value</th>
                          </tr>
                        </thead>
                        <tbody class="divide-y divide-dashed divide-white/10">
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-slate-400">Total Agents</td><td class="py-3 px-4 text-white font-mono">9</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-slate-400">Data Sources</td><td class="py-3 px-4 text-white font-mono">9 categories</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-slate-400">Update Frequency</td><td class="py-3 px-4 text-white font-mono">400ms - 60s</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-slate-400">Decision Latency</td><td class="py-3 px-4 text-white font-mono">15-30 seconds</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-slate-400">Integrated Protocols</td><td class="py-3 px-4 text-white font-mono">7</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-slate-400">Strategies</td><td class="py-3 px-4 text-white font-mono">3</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-slate-400">Max Concurrent Positions</td><td class="py-3 px-4 text-white font-mono">10 total</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-slate-400">Risk Parameters</td><td class="py-3 px-4 text-white font-mono">30+ configurable</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </div>

                  <!-- Docs Footer Pagination -->
                  <div class="mt-20 flex items-center justify-between pt-8 border-t border-dashed border-white/10">
                    <div class="invisible"><!-- Placeholder --></div>
                    <a href="#" data-page="data-layer" class="nav-link group flex flex-col items-end gap-1">
                      <span class="text-xs text-slate-500 uppercase tracking-widest font-medium">Next</span>
                      <span class="text-white font-medium group-hover:text-[#ffffff] transition-colors flex items-center gap-2">
                        Data Layer
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"></path></svg>
                      </span>
                    </a>
                  </div>
                </div>
              </div>
      </main>

      <!-- Right Sidebar (Table of Contents) -->
      <aside class="hidden xl:block col-span-2 sticky top-16 h-[calc(100vh-4rem)] pt-12 pr-8 pl-4">
        <div class="border-l border-white/5 pl-4">
          <h5 class="text-[11px] font-semibold text-white uppercase tracking-widest mb-4">
            On this page
          </h5>
          <ul class="space-y-3 text-xs" id="toc-list">
            <li class="">
              <a href="#" class="text-[#ffffff] font-medium block border-l-2 border-[#ffffff] -ml-[18px] pl-4 transition-all">
                Design Philosophy
              </a>
            </li>
            <li>
              <a href="#" class="text-slate-500 hover:text-white transition-colors block">
                Agent Composition
              </a>
            </li>
            <li class="">
              <a href="#" class="text-slate-500 hover:text-white transition-colors block">
                Decision Flow
              </a>
            </li>
            <li class="">
              <a href="#" class="text-slate-500 hover:text-white transition-colors block">
                Summary Metrics
              </a>
            </li>
          </ul>
        </div>

        <!-- Ad / Promo area for docs -->
        <div class="mt-12 p-4 bg-gradient-to-br from-white/5 to-transparent border border-white/5 rounded-lg">
          <p class="text-[11px] font-semibold text-white mb-2">
            Survival First
          </p>
          <p class="text-[10px] text-slate-400 mb-3 leading-relaxed">
            Every layer includes redundant safety checks. Adversarial debate catches blind spots.
          </p>
          <a href="/Enterprise" class="text-[10px] text-[#ffffff] hover:underline">
            Enterprise Solutions →
          </a>
        </div>
      </aside>
    </div>

    <!-- Page Content Scripts -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
            // Page navigation order for prev/next
            const pageOrder = [
              'system-overview',
              'data-layer',
              'ml-pipeline',
              'analyst-agents',
              'researcher-agents',
              'decision-agents',
              'execution-layer',
              'frameworks',
              'lp-rebalancing',
              'arbitrage',
              'perpetuals',
              'monitoring',
              'circuit-breakers',
              'logging'
            ];

            // Page Data Store - Cortex Technical Architecture
            const pages = {
              'system-overview': {
                category: 'ARCHITECTURE',
                title: 'System Overview',
                subtitle: "Multi-agent autonomous trading system with adversarial validation, designed for survival over profit maximization.",
                toc: ['Design Philosophy', 'Agent Composition', 'Decision Flow', 'Summary Metrics'],
                content: `
                  <div class="mb-12 p-1 bg-gradient-to-r from-[#ffffff]/20 to-transparent rounded-lg border border-[#ffffff]/20">
                    <div class="bg-[#0A0D11] rounded p-5 flex items-start gap-4">
                      <div class="p-2 bg-[#ffffff]/10 rounded text-[#ffffff] mt-1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>
                      </div>
                      <div>
                        <h4 class="text-white font-medium text-sm mb-1">Design Philosophy</h4>
                        <p class="text-sm text-slate-400 leading-relaxed">
                          Survival over profit maximization. Multi-agent adversarial validation. Hard risk limits at every layer. No single point of failure.
                        </p>
                      </div>
                    </div>
                  </div>

                  <div class="prose prose-invert prose-slate max-w-none">
                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Agent Composition</h2>
                    <p class="mb-6 text-sm leading-7 text-slate-400">9 specialized agents work in adversarial configuration to ensure robust decision-making with no single point of failure.</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-12">
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <div class="text-3xl font-light text-white mb-2">4</div>
                        <h3 class="text-white font-medium mb-1">Analyst Agents</h3>
                        <p class="text-sm text-slate-400">Data interpretation specialists</p>
                      </div>
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <div class="text-3xl font-light text-white mb-2">2</div>
                        <h3 class="text-white font-medium mb-1">Researcher Agents</h3>
                        <p class="text-sm text-slate-400">Deep analysis experts</p>
                      </div>
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <div class="text-3xl font-light text-white mb-2">3</div>
                        <h3 class="text-white font-medium mb-1">Decision Agents</h3>
                        <p class="text-sm text-slate-400">Trader, Risk Manager, PM</p>
                      </div>
                    </div>

                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Decision Flow</h2>
                    <div class="border-l border-dashed border-white/10 pl-8 space-y-8 relative mt-6">
                      <div class="relative"><span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">1</span><h3 class="text-white font-medium mb-1">Data Ingestion</h3><p class="text-sm text-slate-400">400ms cycles from 9+ sources</p></div>
                      <div class="relative"><span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">2</span><h3 class="text-white font-medium mb-1">ML Regime Classification</h3><p class="text-sm text-slate-400">Market state identification</p></div>
                      <div class="relative"><span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">3</span><h3 class="text-white font-medium mb-1">Analyst Reports</h3><p class="text-sm text-slate-400">4 specialized analyses</p></div>
                      <div class="relative"><span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">4</span><h3 class="text-white font-medium mb-1">Adversarial Debate</h3><p class="text-sm text-slate-400">Multi-round challenge/defense</p></div>
                      <div class="relative"><span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">5</span><h3 class="text-white font-medium mb-1">Trade Proposal</h3><p class="text-sm text-slate-400">Trader identifies opportunity</p></div>
                      <div class="relative"><span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">6</span><h3 class="text-white font-medium mb-1">Risk Assessment</h3><p class="text-sm text-slate-400">Position sizing and limits</p></div>
                      <div class="relative"><span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#05080A] border border-white/20 text-[10px] font-semibold text-white ring-4 ring-[#05080A]">7</span><h3 class="text-white font-medium mb-1">Final Approval</h3><p class="text-sm text-slate-400">Portfolio Manager decision</p></div>
                      <div class="relative"><span class="absolute -left-[41px] top-0 flex h-6 w-6 items-center justify-center rounded-full bg-[#ffffff] text-black text-[10px] font-semibold ring-4 ring-[#05080A]">8</span><h3 class="text-white font-medium mb-1">Guardian Execution</h3><p class="text-sm text-slate-400">Final validation and blockchain execution</p></div>
                    </div>

                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6 mt-12">Summary Metrics</h2>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-10">
                      <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                        <div class="text-xl font-light text-white">1500+</div>
                        <p class="text-xs text-slate-400">Data points/cycle</p>
                      </div>
                      <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                        <div class="text-xl font-light text-white">8</div>
                        <p class="text-xs text-slate-400">Decision steps</p>
                      </div>
                      <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                        <div class="text-xl font-light text-white">3</div>
                        <p class="text-xs text-slate-400">Veto points</p>
                      </div>
                      <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                        <div class="text-xl font-light text-white">100%</div>
                        <p class="text-xs text-slate-400">Audit coverage</p>
                      </div>
                    </div>
                  </div>
                `
              },
              'data-layer': {
                category: 'ARCHITECTURE',
                title: 'Data Layer',
                subtitle: "Real-time multi-source data ingestion with 400ms update cycles for comprehensive market intelligence.",
                toc: ['Data Sources', 'Ingestion Pipeline'],
                content: `
                  <div class="prose prose-invert prose-slate max-w-none">
                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Data Sources</h2>
                    <div class="overflow-hidden rounded-lg border border-white/10 mb-12">
                      <table class="w-full text-left text-sm border-collapse">
                        <thead><tr class="bg-white/5 border-b border-white/10">
                          <th class="py-3 px-4 font-medium text-white border-r border-dashed border-white/10">Source</th>
                          <th class="py-3 px-4 font-medium text-white border-r border-dashed border-white/10">Update</th>
                          <th class="py-3 px-4 font-medium text-white">Data Types</th>
                        </tr></thead>
                        <tbody class="divide-y divide-dashed divide-white/10">
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Pyth/Switchboard</td><td class="py-3 px-4 border-r border-dashed border-white/10 font-mono text-slate-400">400ms</td><td class="py-3 px-4 text-slate-400">Price feeds, confidence</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Birdeye/Jupiter</td><td class="py-3 px-4 border-r border-dashed border-white/10 font-mono text-slate-400">1s</td><td class="py-3 px-4 text-slate-400">Token metrics, routes</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Helius/Triton</td><td class="py-3 px-4 border-r border-dashed border-white/10 font-mono text-slate-400">Per block</td><td class="py-3 px-4 text-slate-400">Transaction streams</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Protocol APIs</td><td class="py-3 px-4 border-r border-dashed border-white/10 font-mono text-slate-400">5s</td><td class="py-3 px-4 text-slate-400">Drift, Orca, Kamino state</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Social Feeds</td><td class="py-3 px-4 border-r border-dashed border-white/10 font-mono text-slate-400">10s</td><td class="py-3 px-4 text-slate-400">Twitter, Discord, Telegram</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Macro Data</td><td class="py-3 px-4 border-r border-dashed border-white/10 font-mono text-slate-400">60s</td><td class="py-3 px-4 text-slate-400">BTC dominance, fear/greed</td></tr>
                        </tbody>
                      </table>
                    </div>

                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Ingestion Pipeline</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-10">
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <h3 class="text-white font-medium mb-2">Normalization</h3>
                        <p class="text-sm text-slate-400">Standard schema across all sources for consistent processing</p>
                      </div>
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <h3 class="text-white font-medium mb-2">Validation</h3>
                        <p class="text-sm text-slate-400">Cross-reference and outlier detection for data integrity</p>
                      </div>
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <h3 class="text-white font-medium mb-2">Enrichment</h3>
                        <p class="text-sm text-slate-400">Technical indicators, derived metrics calculation</p>
                      </div>
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <h3 class="text-white font-medium mb-2">Distribution</h3>
                        <p class="text-sm text-slate-400">Pub/sub to all consuming agents in real-time</p>
                      </div>
                    </div>
                  </div>
                `
              },
              'ml-pipeline': {
                 category: 'ARCHITECTURE',
                 title: 'ML Pipeline',
                 subtitle: "Regime classification and signal generation for market state detection and opportunity identification.",
                 toc: ['Regime Classification', 'Signal Generation', 'Confidence Thresholds'],
                 content: `
                  <div class="prose prose-invert prose-slate max-w-none">
                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Regime Classification</h2>
                    <p class="mb-6 text-sm text-slate-400">Identifies current market state to adjust strategy parameters dynamically.</p>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-10">
                      <div class="p-4 border border-green-500/20 rounded-lg bg-green-500/5 text-center"><span class="text-green-400 font-medium text-sm">Trending</span></div>
                      <div class="p-4 border border-yellow-500/20 rounded-lg bg-yellow-500/5 text-center"><span class="text-yellow-400 font-medium text-sm">Mean Reverting</span></div>
                      <div class="p-4 border border-blue-500/20 rounded-lg bg-blue-500/5 text-center"><span class="text-blue-400 font-medium text-sm">High Volatility</span></div>
                      <div class="p-4 border border-red-500/20 rounded-lg bg-red-500/5 text-center"><span class="text-red-400 font-medium text-sm">Crisis</span></div>
                    </div>

                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Signal Generation</h2>
                    <div class="overflow-hidden rounded-lg border border-white/10 mb-12">
                      <table class="w-full text-left text-sm border-collapse">
                        <thead><tr class="bg-white/5 border-b border-white/10">
                          <th class="py-3 px-4 font-medium text-white border-r border-dashed border-white/10">Model</th>
                          <th class="py-3 px-4 font-medium text-white border-r border-dashed border-white/10">Output</th>
                          <th class="py-3 px-4 font-medium text-white">Confidence</th>
                        </tr></thead>
                        <tbody class="divide-y divide-dashed divide-white/10">
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Momentum</td><td class="py-3 px-4 border-r border-dashed border-white/10 text-slate-400">Direction + strength</td><td class="py-3 px-4 font-mono text-slate-400">0-100%</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Mean Reversion</td><td class="py-3 px-4 border-r border-dashed border-white/10 text-slate-400">Deviation signals</td><td class="py-3 px-4 font-mono text-slate-400">0-100%</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Volatility</td><td class="py-3 px-4 border-r border-dashed border-white/10 text-slate-400">Expected ranges</td><td class="py-3 px-4 font-mono text-slate-400">0-100%</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Sentiment</td><td class="py-3 px-4 border-r border-dashed border-white/10 text-slate-400">Bullish/bearish</td><td class="py-3 px-4 font-mono text-slate-400">0-100%</td></tr>
                        </tbody>
                      </table>
                    </div>

                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Confidence Thresholds</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-10">
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <div class="text-2xl font-light text-white mb-1">≥84%</div>
                        <p class="text-sm text-slate-400">LP Rebalancing</p>
                      </div>
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <div class="text-2xl font-light text-white mb-1">≥80%</div>
                        <p class="text-sm text-slate-400">Arbitrage</p>
                      </div>
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <div class="text-2xl font-light text-white mb-1">≥50-60%</div>
                        <p class="text-sm text-slate-400">Perpetuals</p>
                      </div>
                    </div>
                  </div>
                 `
              },
              'analyst-agents': {
                category: 'AGENT LAYER',
                title: 'Analyst Agents',
                subtitle: "Four specialized agents providing comprehensive market analysis from different perspectives.",
                toc: ['Technical Analyst', 'Sentiment Analyst', 'On-chain Analyst', 'Macro Analyst'],
                content: `
                  <div class="prose prose-invert prose-slate max-w-none">
                    <div class="space-y-6 mb-10">
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <h3 class="text-white font-medium mb-2">Technical Analyst</h3>
                        <p class="text-sm text-slate-400 mb-3">Processes price data, volume, indicators (RSI, MACD, Bollinger).</p>
                        <div class="text-xs text-slate-500">Output: Support/resistance levels, trend analysis, pattern recognition</div>
                      </div>
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <h3 class="text-white font-medium mb-2">On-Chain Analyst</h3>
                        <p class="text-sm text-slate-400 mb-3">Monitors wallet flows, whale activity, protocol TVL changes.</p>
                        <div class="text-xs text-slate-500">Output: Smart money movement, accumulation/distribution signals</div>
                      </div>
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <h3 class="text-white font-medium mb-2">Sentiment Analyst</h3>
                        <p class="text-sm text-slate-400 mb-3">Processes social feeds, news, community sentiment.</p>
                        <div class="text-xs text-slate-500">Output: Sentiment scores, narrative tracking, FUD detection</div>
                      </div>
                      <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                        <h3 class="text-white font-medium mb-2">Macro Analyst</h3>
                        <p class="text-sm text-slate-400 mb-3">Tracks BTC dominance, correlation matrices, risk-on/off.</p>
                        <div class="text-xs text-slate-500">Output: Market regime assessment, correlation warnings</div>
                      </div>
                    </div>
                  </div>
                `
              },
              'researcher-agents': {
                 category: 'AGENT LAYER',
                 title: 'Researcher Agents',
                 subtitle: "Deep analysis specialists that investigate specific opportunities identified by analysts.",
                 toc: ['Protocol Researcher', 'Risk Researcher'],
                 content: `
                   <div class="prose prose-invert prose-slate max-w-none">
                     <div class="space-y-6 mb-10">
                       <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                         <h3 class="text-white font-medium mb-2">Protocol Researcher</h3>
                         <p class="text-sm text-slate-400 mb-3">Deep dives into specific protocol mechanics when opportunity identified.</p>
                         <div class="text-xs text-slate-500">Output: Pool analysis, fee structures, risk assessment</div>
                       </div>
                       <div class="p-5 border border-white/10 rounded-lg bg-white/[0.02]">
                         <h3 class="text-white font-medium mb-2">Risk Researcher</h3>
                         <p class="text-sm text-slate-400 mb-3">Investigates specific risks: IL calculations, liquidation scenarios.</p>
                         <div class="text-xs text-slate-500">Output: Quantified risk metrics, worst-case scenarios</div>
                       </div>
                     </div>
                   </div>
                 `
              },
              'decision-agents': {
                category: 'AGENT LAYER',
                title: 'Decision Agents',
                subtitle: "Three key agents responsible for trade execution, risk management, and final portfolio decisions.",
                toc: ['Trader Agent', 'Risk Manager Agent', 'Portfolio Manager Agent', 'Adversarial Debate'],
                content: `
                  <div class="prose prose-invert prose-slate max-w-none">
                    <div class="space-y-6 mb-10">
                      <div class="p-5 border border-blue-500/20 rounded-lg bg-blue-500/5">
                        <h3 class="text-blue-400 font-medium mb-2">Trader Agent</h3>
                        <p class="text-sm text-slate-400 mb-3">Synthesizes all analysis to identify trade opportunities. Proposes entry/exit with detailed reasoning.</p>
                        <div class="text-xs text-blue-400/70 mt-2">Minimum confidence: 84% for LP, 80% for Arb, 50-60% for Perps</div>
                      </div>
                      <div class="p-5 border border-yellow-500/20 rounded-lg bg-yellow-500/5">
                        <h3 class="text-yellow-400 font-medium mb-2">Risk Manager Agent</h3>
                        <p class="text-sm text-slate-400 mb-3">Independent risk assessment. Position sizing based on Kelly criterion (fractional). Enforces hard limits.</p>
                        <div class="text-xs text-yellow-400/70 mt-2">Limits: Max 5% single position, 15% correlated exposure, 5% daily drawdown</div>
                      </div>
                      <div class="p-5 border border-green-500/20 rounded-lg bg-green-500/5">
                        <h3 class="text-green-400 font-medium mb-2">Portfolio Manager Agent</h3>
                        <p class="text-sm text-slate-400 mb-3">Final decision authority. Weighs Trader vs Risk Manager arguments. Can veto or modify any trade.</p>
                        <div class="text-xs text-green-400/70 mt-2">Manages overall portfolio balance and capital allocation across strategies</div>
                      </div>
                    </div>

                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Adversarial Debate</h2>
                    <p class="text-sm text-slate-400 mb-4">Multi-round challenge/defense process before any trade execution:</p>
                    <div class="border-l-2 border-white/10 pl-6 space-y-4 mb-10">
                      <div><span class="text-white font-medium">Round 1:</span> <span class="text-slate-400 text-sm">Trader presents opportunity with supporting evidence</span></div>
                      <div><span class="text-white font-medium">Round 2:</span> <span class="text-slate-400 text-sm">Risk Manager challenges with counterarguments</span></div>
                      <div><span class="text-white font-medium">Round 3:</span> <span class="text-slate-400 text-sm">Trader defends or modifies proposal</span></div>
                      <div><span class="text-white font-medium">Final:</span> <span class="text-slate-400 text-sm">Portfolio Manager makes final decision with reasoning</span></div>
                    </div>
                  </div>
                `
              },
              'execution-layer': {
                 category: 'EXECUTION',
                 title: 'Execution Layer',
                 subtitle: "Guardian validator and transaction executor ensuring safe, optimized blockchain execution.",
                 toc: ['Guardian Validator', 'Transaction Executor'],
                 content: `
                   <div class="prose prose-invert prose-slate max-w-none">
                     <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Guardian Validator</h2>
                     <p class="mb-6 text-sm text-slate-400">Final safety check before any transaction touches the blockchain.</p>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-10">
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]"><span class="text-white text-sm">Transaction simulation</span></div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]"><span class="text-white text-sm">Slippage verification</span></div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]"><span class="text-white text-sm">Balance confirmation</span></div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]"><span class="text-white text-sm">Rate limit checking</span></div>
                     </div>

                     <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Transaction Executor</h2>
                     <div class="overflow-hidden rounded-lg border border-white/10 mb-12">
                       <table class="w-full text-left text-sm border-collapse">
                         <thead><tr class="bg-white/5 border-b border-white/10">
                           <th class="py-3 px-4 font-medium text-white border-r border-dashed border-white/10">Feature</th>
                           <th class="py-3 px-4 font-medium text-white">Description</th>
                         </tr></thead>
                         <tbody class="divide-y divide-dashed divide-white/10">
                           <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Jito Bundles</td><td class="py-3 px-4 text-slate-400">MEV protection for sensitive trades</td></tr>
                           <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Priority Fees</td><td class="py-3 px-4 text-slate-400">Dynamic adjustment based on network</td></tr>
                           <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Retry Logic</td><td class="py-3 px-4 text-slate-400">Exponential backoff with recalculation</td></tr>
                           <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Confirmation</td><td class="py-3 px-4 text-slate-400">Wait for finality, verify state change</td></tr>
                         </tbody>
                       </table>
                     </div>
                   </div>
                 `
              },
              'frameworks': {
                category: 'EXECUTION',
                title: 'Agent Frameworks',
                subtitle: "ElizaOS for cognitive processing and Solana Agent Kit (Sendai) for blockchain execution.",
                toc: ['ElizaOS', 'Solana Agent Kit (Sendai)'],
                content: `
                  <div class="prose prose-invert prose-slate max-w-none">
                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">ElizaOS</h2>
                    <p class="mb-4 text-sm text-slate-400">Provides the cognitive layer for all agents.</p>
                    <div class="grid grid-cols-2 gap-3 mb-10">
                      <div class="p-3 border border-white/10 rounded bg-white/[0.02] text-sm text-slate-400">Memory management</div>
                      <div class="p-3 border border-white/10 rounded bg-white/[0.02] text-sm text-slate-400">Goal tracking</div>
                      <div class="p-3 border border-white/10 rounded bg-white/[0.02] text-sm text-slate-400">Tool orchestration</div>
                      <div class="p-3 border border-white/10 rounded bg-white/[0.02] text-sm text-slate-400">Multi-model support</div>
                    </div>

                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Solana Agent Kit (Sendai)</h2>
                    <p class="mb-4 text-sm text-slate-400">Blockchain execution capabilities.</p>
                    <div class="overflow-hidden rounded-lg border border-white/10 mb-12">
                      <table class="w-full text-left text-sm border-collapse">
                        <thead><tr class="bg-white/5 border-b border-white/10">
                          <th class="py-3 px-4 font-medium text-white border-r border-dashed border-white/10">Protocol</th>
                          <th class="py-3 px-4 font-medium text-white">Capabilities</th>
                        </tr></thead>
                        <tbody class="divide-y divide-dashed divide-white/10">
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Drift</td><td class="py-3 px-4 text-slate-400">Position management, funding payments</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Jupiter</td><td class="py-3 px-4 text-slate-400">Swap routing, aggregation</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Orca</td><td class="py-3 px-4 text-slate-400">LP management, concentrated liquidity</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Kamino</td><td class="py-3 px-4 text-slate-400">Vault deposits, yield optimization</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">MarginFi/Solend</td><td class="py-3 px-4 text-slate-400">Lending, borrowing, liquidations</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                `
              },
              'lp-rebalancing': {
                 category: 'STRATEGIES',
                 title: 'LP Rebalancing',
                 subtitle: "Concentrated liquidity management with continuous IL monitoring and auto-exit thresholds.",
                 toc: ['Parameters', 'Entry Criteria', 'Exit Triggers'],
                 content: `
                   <div class="prose prose-invert prose-slate max-w-none">
                     <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-10">
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                         <div class="text-xl font-light text-white">40%</div>
                         <p class="text-xs text-slate-400">Capital Allocation</p>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                         <div class="text-xl font-light text-white">3</div>
                         <p class="text-xs text-slate-400">Max Positions</p>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                         <div class="text-xl font-light text-white">2-3%</div>
                         <p class="text-xs text-slate-400">IL Threshold</p>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                         <div class="text-xl font-light text-white">0.5%</div>
                         <p class="text-xs text-slate-400">Slippage Tolerance</p>
                       </div>
                     </div>

                     <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Entry Criteria</h2>
                     <ul class="space-y-2 mb-10">
                       <li class="flex items-center gap-2 text-sm text-slate-400"><span class="text-green-400">✓</span> ML confidence ≥ 84%</li>
                       <li class="flex items-center gap-2 text-sm text-slate-400"><span class="text-green-400">✓</span> Pool TVL above minimum</li>
                       <li class="flex items-center gap-2 text-sm text-slate-400"><span class="text-green-400">✓</span> Expected fee APY > gas costs</li>
                       <li class="flex items-center gap-2 text-sm text-slate-400"><span class="text-green-400">✓</span> IL risk assessment acceptable</li>
                     </ul>

                     <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Exit Triggers</h2>
                     <ul class="space-y-2 mb-10">
                       <li class="flex items-center gap-2 text-sm text-slate-400"><span class="text-red-400">×</span> IL exceeds threshold</li>
                       <li class="flex items-center gap-2 text-sm text-slate-400"><span class="text-red-400">×</span> Pool TVL drops below minimum</li>
                       <li class="flex items-center gap-2 text-sm text-slate-400"><span class="text-red-400">×</span> Better opportunity identified</li>
                       <li class="flex items-center gap-2 text-sm text-slate-400"><span class="text-red-400">×</span> Strategy circuit breaker</li>
                     </ul>
                   </div>
                 `
              },
              'arbitrage': {
                category: 'STRATEGIES',
                title: 'Arbitrage',
                subtitle: "DEX-to-DEX arbitrage with atomic execution and MEV protection via Jito bundles.",
                toc: ['Parameters', 'Execution'],
                content: `
                  <div class="prose prose-invert prose-slate max-w-none">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-10">
                      <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                        <div class="text-xl font-light text-white">30%</div>
                        <p class="text-xs text-slate-400">Capital Allocation</p>
                      </div>
                      <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                        <div class="text-xl font-light text-white">5</div>
                        <p class="text-xs text-slate-400">Max Concurrent</p>
                      </div>
                      <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                        <div class="text-xl font-light text-white">≥0.5%</div>
                        <p class="text-xs text-slate-400">Min Spread</p>
                      </div>
                      <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                        <div class="text-xl font-light text-white">80%</div>
                        <p class="text-xs text-slate-400">ML Confidence</p>
                      </div>
                    </div>

                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Execution</h2>
                    <ul class="space-y-2 mb-10">
                      <li class="flex items-center gap-2 text-sm text-slate-400"><span class="text-blue-400">→</span> Atomic when possible</li>
                      <li class="flex items-center gap-2 text-sm text-slate-400"><span class="text-blue-400">→</span> Jito bundle for MEV protection</li>
                      <li class="flex items-center gap-2 text-sm text-slate-400"><span class="text-blue-400">→</span> Size limited by thinner side</li>
                      <li class="flex items-center gap-2 text-sm text-slate-400"><span class="text-blue-400">→</span> Abort if conditions change</li>
                    </ul>
                  </div>
                `
              },
              'perpetuals': {
                 category: 'STRATEGIES',
                 title: 'Perpetuals',
                 subtitle: "Leveraged perpetual futures trading with strict risk controls and position limits.",
                 toc: ['Parameters', 'Position Parameters'],
                 content: `
                   <div class="prose prose-invert prose-slate max-w-none">
                     <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-10">
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                         <div class="text-xl font-light text-white">30%</div>
                         <p class="text-xs text-slate-400">Capital Allocation</p>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                         <div class="text-xl font-light text-white">≤5x</div>
                         <p class="text-xs text-slate-400">Max Leverage</p>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                         <div class="text-xl font-light text-white">8h</div>
                         <p class="text-xs text-slate-400">Max Hold Time</p>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02] text-center">
                         <div class="text-xl font-light text-white">2</div>
                         <p class="text-xs text-slate-400">Max Positions</p>
                       </div>
                     </div>

                     <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Position Parameters</h2>
                     <div class="overflow-hidden rounded-lg border border-white/10 mb-12">
                       <table class="w-full text-left text-sm border-collapse">
                         <tbody class="divide-y divide-dashed divide-white/10">
                           <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Stop Loss</td><td class="py-3 px-4 text-slate-400">5% (fixed)</td></tr>
                           <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Take Profit</td><td class="py-3 px-4 text-slate-400">10% (fixed)</td></tr>
                           <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Liquidation Distance</td><td class="py-3 px-4 text-slate-400">≥15%</td></tr>
                           <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Min Margin Ratio</td><td class="py-3 px-4 text-slate-400">20%</td></tr>
                           <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Auto-deleverage</td><td class="py-3 px-4 text-slate-400">At 10% margin</td></tr>
                         </tbody>
                       </table>
                     </div>
                   </div>
                 `
              },
              'monitoring': {
                category: 'OPERATIONS',
                title: 'Monitoring & Alerts',
                subtitle: "Real-time monitoring with configurable alert thresholds and automatic response actions.",
                toc: ['Alert Thresholds'],
                content: `
                  <div class="prose prose-invert prose-slate max-w-none">
                    <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Alert Thresholds</h2>
                    <div class="overflow-hidden rounded-lg border border-white/10 mb-12">
                      <table class="w-full text-left text-sm border-collapse">
                        <thead><tr class="bg-white/5 border-b border-white/10">
                          <th class="py-3 px-4 font-medium text-white border-r border-dashed border-white/10">Metric</th>
                          <th class="py-3 px-4 font-medium text-white border-r border-dashed border-white/10">Threshold</th>
                          <th class="py-3 px-4 font-medium text-white">Action</th>
                        </tr></thead>
                        <tbody class="divide-y divide-dashed divide-white/10">
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Daily Drawdown</td><td class="py-3 px-4 border-r border-dashed border-white/10 text-yellow-400">3%</td><td class="py-3 px-4 text-slate-400">Warning notification</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Daily Drawdown</td><td class="py-3 px-4 border-r border-dashed border-white/10 text-red-400">5%</td><td class="py-3 px-4 text-slate-400">Pause all strategies</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Weekly Drawdown</td><td class="py-3 px-4 border-r border-dashed border-white/10 text-red-400">10%</td><td class="py-3 px-4 text-slate-400">Full stop, manual review</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Oracle Staleness</td><td class="py-3 px-4 border-r border-dashed border-white/10 text-yellow-400">30s</td><td class="py-3 px-4 text-slate-400">Reject new trades</td></tr>
                          <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Execution Failure</td><td class="py-3 px-4 border-r border-dashed border-white/10 text-yellow-400">10%</td><td class="py-3 px-4 text-slate-400">Alert, investigate</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                `
              },
              'circuit-breakers': {
                 category: 'OPERATIONS',
                 title: 'Circuit Breakers',
                 subtitle: "Per-strategy and global circuit breakers with automatic recovery mechanisms.",
                 toc: ['Per-Strategy Breakers', 'Global Breakers', 'Recovery'],
                 content: `
                   <div class="prose prose-invert prose-slate max-w-none">
                     <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Per-Strategy Breakers</h2>
                     <div class="space-y-4 mb-10">
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]">
                         <h4 class="text-white font-medium mb-1">LP Rebalancing</h4>
                         <p class="text-sm text-slate-400">Pause if 3 consecutive IL exits</p>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]">
                         <h4 class="text-white font-medium mb-1">Arbitrage</h4>
                         <p class="text-sm text-slate-400">Pause if 5 consecutive failed executions</p>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]">
                         <h4 class="text-white font-medium mb-1">Perpetuals</h4>
                         <p class="text-sm text-slate-400">Pause if 2 consecutive stop-loss hits</p>
                       </div>
                     </div>

                     <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Global Breakers</h2>
                     <div class="p-4 border border-red-500/20 rounded-lg bg-red-500/5 mb-6">
                       <p class="text-sm text-red-400"><strong>5% daily drawdown:</strong> Pause all strategies</p>
                     </div>
                     <div class="p-4 border border-red-500/20 rounded-lg bg-red-500/5 mb-10">
                       <p class="text-sm text-red-400"><strong>10% weekly drawdown:</strong> Full stop, require manual review</p>
                     </div>

                     <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Recovery</h2>
                     <p class="text-sm text-slate-400">Automatic resume after 1 hour if conditions normalize. Full stop events require manual intervention.</p>
                   </div>
                 `
              },
              'logging': {
                 category: 'OPERATIONS',
                 title: 'Performance Logging',
                 subtitle: "Comprehensive decision logging with full audit trail and multi-tier storage.",
                 toc: ['Logged Data', 'Storage Tiers'],
                 content: `
                   <div class="prose prose-invert prose-slate max-w-none">
                     <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Logged Data</h2>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-10">
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]">
                         <span class="text-white text-sm">Timestamp (block + wall)</span>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]">
                         <span class="text-white text-sm">All analyst reports</span>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]">
                         <span class="text-white text-sm">Debate transcript + scores</span>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]">
                         <span class="text-white text-sm">Trade proposal details</span>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]">
                         <span class="text-white text-sm">Risk assessment</span>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]">
                         <span class="text-white text-sm">Final decision + reasoning</span>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]">
                         <span class="text-white text-sm">Execution result</span>
                       </div>
                       <div class="p-4 border border-white/10 rounded-lg bg-white/[0.02]">
                         <span class="text-white text-sm">P&L attribution</span>
                       </div>
                     </div>

                     <h2 class="text-2xl font-medium text-white tracking-tight mb-6">Storage Tiers</h2>
                     <div class="overflow-hidden rounded-lg border border-white/10 mb-12">
                       <table class="w-full text-left text-sm border-collapse">
                         <tbody class="divide-y divide-dashed divide-white/10">
                           <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Hot Storage</td><td class="py-3 px-4 text-slate-400">7 days</td></tr>
                           <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Warm Storage</td><td class="py-3 px-4 text-slate-400">90 days</td></tr>
                           <tr><td class="py-3 px-4 border-r border-dashed border-white/10 text-white">Cold Storage</td><td class="py-3 px-4 text-slate-400">Indefinite (compressed)</td></tr>
                         </tbody>
                       </table>
                     </div>
                   </div>
                 `
              }
            };

            const contentContainer = document.getElementById('content-container');
            const navLinks = document.querySelectorAll('.nav-link');

            function renderPage(pageId) {
              const page = pages[pageId];
              if (!page) return;

              // 1. Build Content HTML
              const html = `
                <div class="fade-in">
                  <!-- Breadcrumbs -->
                  <div class="flex items-center gap-2 text-xs text-slate-500 mb-8 font-mono">
                    <span>DOCS</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="m9 18 6-6-6-6"></path>
                    </svg>
                    <span class="">${page.category}</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="m9 18 6-6-6-6"></path>
                    </svg>
                    <span class="text-[#ffffff] uppercase">${page.title}</span>
                  </div>

                  <!-- Header -->
                  <h1 class="text-4xl md:text-5xl font-light tracking-tighter text-white mb-6">
                    ${page.title}
                  </h1>
                  <p class="text-lg md:text-xl text-white/60 font-light leading-relaxed mb-10 max-w-3xl">
                    ${page.subtitle}
                  </p>

                  ${page.content}

                  <!-- Docs Footer Pagination - Dynamic -->
                  <div id="pagination-container" class="mt-20 flex items-center justify-between pt-8 border-t border-dashed border-white/10"></div>
                </div>
              `;

              // 2. Inject Content
              contentContainer.innerHTML = html;

              // 3. Build pagination
              const currentIndex = pageOrder.indexOf(pageId);
              const prevPage = currentIndex > 0 ? pageOrder[currentIndex - 1] : null;
              const nextPage = currentIndex < pageOrder.length - 1 ? pageOrder[currentIndex + 1] : null;

              const paginationContainer = document.getElementById('pagination-container');
              let paginationHTML = '';

              if (prevPage && pages[prevPage]) {
                paginationHTML += `
                  <a href="#${prevPage}" class="pagination-link group flex flex-col items-start gap-1" data-page="${prevPage}">
                    <span class="text-xs text-slate-500 uppercase tracking-widest font-medium">Previous</span>
                    <span class="text-white font-medium group-hover:text-[#ffffff] transition-colors flex items-center gap-2">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"></path></svg>
                      ${pages[prevPage].title}
                    </span>
                  </a>`;
              } else {
                paginationHTML += '<div></div>';
              }

              if (nextPage && pages[nextPage]) {
                paginationHTML += `
                  <a href="#${nextPage}" class="pagination-link group flex flex-col items-end gap-1" data-page="${nextPage}">
                    <span class="text-xs text-slate-500 uppercase tracking-widest font-medium">Next</span>
                    <span class="text-white font-medium group-hover:text-[#ffffff] transition-colors flex items-center gap-2">
                      ${pages[nextPage].title}
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"></path></svg>
                    </span>
                  </a>`;
              } else {
                paginationHTML += '<div></div>';
              }

              paginationContainer.innerHTML = paginationHTML;

              // Add click handlers for pagination
              document.querySelectorAll('.pagination-link').forEach(link => {
                link.addEventListener('click', (e) => {
                  e.preventDefault();
                  const targetPage = link.getAttribute('data-page');
                  navigateTo(targetPage);
                });
              });

              // 4. Re-initialize icons for new content safely
              if (window.lucide && window.lucide.createIcons) {
                window.lucide.createIcons();
              }

              // 5. Update Sidebar Active State
              navLinks.forEach(link => {
                const indicator = link.querySelector('.indicator');

                if (link.getAttribute('data-page') === pageId) {
                  link.classList.remove('text-slate-400', 'hover:text-white', 'hover:bg-white/5', 'border-transparent');
                  link.classList.add('text-white', 'font-medium', 'bg-white/5', 'border-white/5');
                  if(indicator) indicator.classList.remove('hidden');
                } else {
                  link.classList.add('text-slate-400', 'hover:text-white', 'hover:bg-white/5', 'border-transparent');
                  link.classList.remove('text-white', 'font-medium', 'bg-white/5', 'border-white/5');
                  if(indicator) indicator.classList.add('hidden');
                }
              });

              // 6. Update TOC (right sidebar)
              const tocList = document.getElementById('toc-list');
              if (tocList && page.toc && page.toc.length > 0) {
                let tocHTML = '';
                page.toc.forEach((item, index) => {
                  if (index === 0) {
                    tocHTML += `<li><a href="#" class="text-[#ffffff] font-medium block border-l-2 border-[#ffffff] -ml-[18px] pl-4 transition-all">${item}</a></li>`;
                  } else {
                    tocHTML += `<li><a href="#" class="text-slate-500 hover:text-white transition-colors block">${item}</a></li>`;
                  }
                });
                tocList.innerHTML = tocHTML;
              }

              // 7. Scroll to top
              window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            // Navigation function with hash update
            function navigateTo(pageId) {
              if (pages[pageId]) {
                window.location.hash = pageId;
              }
            }

            // Event Listeners for sidebar
            navLinks.forEach(link => {
              link.addEventListener('click', (e) => {
                e.preventDefault();
                const pageId = link.getAttribute('data-page');
                navigateTo(pageId);
              });
            });

            // Handle hash changes (browser back/forward)
            window.addEventListener('hashchange', () => {
              const hash = window.location.hash.slice(1);
              if (hash && pages[hash]) {
                renderPage(hash);
              }
            });

            // Initial Load - check hash or default to system-overview
            const initialHash = window.location.hash.slice(1);
            if (initialHash && pages[initialHash]) {
              renderPage(initialHash);
            } else {
              navigateTo('system-overview');
            }

            // Mobile Menu Functions
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileSidebar = document.getElementById('mobile-sidebar');
            const mobileOverlay = document.getElementById('mobile-sidebar-overlay');
            const mobileNav = document.getElementById('mobile-nav');

            // Build mobile nav from existing nav
            function buildMobileNav() {
              const sections = [
                { title: 'Architecture', pages: ['system-overview', 'data-layer', 'ml-pipeline'] },
                { title: 'Agent Layer', pages: ['analyst-agents', 'researcher-agents', 'decision-agents'] },
                { title: 'Execution', pages: ['execution-layer', 'frameworks'] },
                { title: 'Strategies', pages: ['lp-rebalancing', 'arbitrage', 'perpetuals'] },
                { title: 'Operations', pages: ['monitoring', 'circuit-breakers', 'logging'] }
              ];

              let html = '';
              sections.forEach(section => {
                html += `<div><h4 class="text-[11px] uppercase tracking-widest font-semibold text-slate-500 mb-3">${section.title}</h4><ul class="space-y-1">`;
                section.pages.forEach(pageId => {
                  if (pages[pageId]) {
                    html += `<li><a href="#${pageId}" class="mobile-nav-link block px-3 py-2 text-sm text-slate-400 hover:text-white hover:bg-white/5 rounded-md transition-all" data-page="${pageId}">${pages[pageId].title}</a></li>`;
                  }
                });
                html += '</ul></div>';
              });
              mobileNav.innerHTML = html;

              // Add click handlers
              document.querySelectorAll('.mobile-nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                  e.preventDefault();
                  const pageId = link.getAttribute('data-page');
                  navigateTo(pageId);
                  closeMobileMenu();
                });
              });
            }

            function openMobileMenu() {
              mobileSidebar.classList.remove('-translate-x-full');
              mobileOverlay.classList.remove('hidden');
              document.body.style.overflow = 'hidden';
            }

            function closeMobileMenu() {
              mobileSidebar.classList.add('-translate-x-full');
              mobileOverlay.classList.add('hidden');
              document.body.style.overflow = '';
            }

            // Make closeMobileMenu global for onclick
            window.closeMobileMenu = closeMobileMenu;

            mobileMenuBtn.addEventListener('click', openMobileMenu);
            buildMobileNav();

            // Search Functionality
            const searchInput = document.getElementById('search-input');
            const searchResults = document.getElementById('search-results');

            function searchDocs(query) {
              if (!query || query.length < 2) {
                searchResults.classList.add('hidden');
                return;
              }

              const q = query.toLowerCase();
              const results = [];

              Object.keys(pages).forEach(pageId => {
                const page = pages[pageId];
                const titleMatch = page.title.toLowerCase().includes(q);
                const subtitleMatch = page.subtitle.toLowerCase().includes(q);
                const categoryMatch = page.category.toLowerCase().includes(q);

                if (titleMatch || subtitleMatch || categoryMatch) {
                  results.push({ pageId, page, titleMatch });
                }
              });

              if (results.length === 0) {
                searchResults.innerHTML = '<div class="p-4 text-sm text-slate-500">No results found</div>';
              } else {
                let html = '';
                results.forEach(({ pageId, page }) => {
                  html += `<a href="#${pageId}" class="search-result block p-3 hover:bg-white/5 border-b border-white/5 last:border-0 transition-colors" data-page="${pageId}">
                    <div class="text-white text-sm font-medium">${page.title}</div>
                    <div class="text-xs text-slate-500">${page.category}</div>
                  </a>`;
                });
                searchResults.innerHTML = html;

                document.querySelectorAll('.search-result').forEach(result => {
                  result.addEventListener('click', (e) => {
                    e.preventDefault();
                    const pageId = result.getAttribute('data-page');
                    navigateTo(pageId);
                    searchInput.value = '';
                    searchResults.classList.add('hidden');
                  });
                });
              }

              searchResults.classList.remove('hidden');
            }

            searchInput.addEventListener('input', (e) => searchDocs(e.target.value));
            searchInput.addEventListener('focus', () => {
              if (searchInput.value.length >= 2) searchDocs(searchInput.value);
            });

            document.addEventListener('click', (e) => {
              if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                searchResults.classList.add('hidden');
              }
            });
      }); // End DOMContentLoaded
    </script>
</body>
</html>